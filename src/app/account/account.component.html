<h1>My Account</h1>
<div >
    <div *ngIf="isValid">
        <button (click) ="checkUser(profile?.userPrincipalName)">Click First</button>
        <button (click)= "getUser(profile?.userPrincipalName, profile?.givenName, profile?.surname, exists)">Get Account Details</button>    
    </div>
    <p><strong>First Name: </strong> {{profile?.givenName}}</p>
    <p><strong>Last Name: </strong> {{profile?.surname}}</p>
    <p><strong>Email: </strong> {{profile?.userPrincipalName}}</p>
</div>

<div *ngIf="!isValid">
    <button (click)="routeToDevice(user.userId)">Add a Device</button>
    <button (click)="routeToFamilyPlan(user.userId)">Add a Family Plan</button>
    <button (click)="routeToWorkPlan(user.userId)">Add a Work Plan</button>
    <button (click)="routeToEnterprisePlan(user.userId)">Add a Enterprise Plan</button>

    <!-- <p>{{user.userId}}</p>
    <p>{{user.firstName}}</p>
    <p>{{user.lastName}}</p>
    <p>{{user.email}}</p> -->
</div>
<table class="table table-bordered table-striped">
    <thead>
        <tr>
            <th>Model</th>
            <th>PhoneNumber</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let device of user.devices">
            <th>{{ device.model }}</th>
            <th>{{ device.phoneNumber }}</th>
            <th>
                <button type="button" class="btn btn-danger" (click)="deleteDevice(user.userId, device.deviceId)">Remove Device</button>
            </th>
        </tr>
    </tbody>
</table>

<table class="table table-bordered table-striped">
    <thead>
        <tr>
            <th>Type</th>
            <th>Number of Lines</th>
            <th>Active Lines</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let plan of user.plans">
            <ng-container *ngIf="plan.type== '0'">
                <th>Family</th>
            </ng-container>
            <ng-container *ngIf="plan.type== '1'">
                <th>Work</th>
            </ng-container>
            <ng-container *ngIf="plan.type== '2'">
                <th>Enterprise</th>
            </ng-container>
            <th>{{ plan.phoneLines }}</th>
            <th>{{ plan.numberLines }}</th>
            <th>
                <button type="button" class="btn btn-danger" (click)="deletePlan(user.userId, plan.planId)">Remove Plan</button>
                <ng-container *ngIf="plan.numberLines != plan.phoneLines">
                    <button type="button" class="btn btn-warning" (click)="addDevice(user.userId, plan.planId)">Add Device</button>
                </ng-container>
                <button type="button" class="btn btn-danger" (click)="deleteDeivceFromPlan(user.userId, plan.planId)">Remove Device</button>
            </th>
        </tr>
    </tbody>
</table>

<table class="table table-bordered table-striped">
    <thead>
        <tr>
            <th>Type</th>
            <th>Number of Lines</th>
            <th>Active Lines</th>
            <th>Bill</th>
        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let plan of user.plans">
            <ng-container *ngIf="plan.type== '0'">
                <th>Family</th>
            </ng-container>
            <ng-container *ngIf="plan.type== '1'">
                <th>Work</th>
            </ng-container>
            <ng-container *ngIf="plan.type== '2'">
                <th>Enterprise</th>
            </ng-container> 
            <th>{{ plan.phoneLines }}</th>
            <th>{{ plan.numberLines }}</th>
            <ng-container *ngIf="plan.type== '0'">
                <th>{{ plan.numberLines * 20 + 25}} </th>
            </ng-container>
            <ng-container *ngIf="plan.type== '1'">
                <th>{{ plan.numberLines * 10 + 75}} </th>
            </ng-container>
            <ng-container *ngIf="plan.type== '2'">
                <th>{{ plan.numberLines * 5 + 125}} </th>
            </ng-container>
        </tr>
    </tbody>
</table>